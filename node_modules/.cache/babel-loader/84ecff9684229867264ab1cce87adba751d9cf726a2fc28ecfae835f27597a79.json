{"ast":null,"code":"import{useState,useEffect}from'react';import axios from'axios';// URL DE TU BACKEND DJANGO\nconst API_BASE_URL='http://127.0.0.1:8000';const api=axios.create({baseURL:API_BASE_URL,timeout:10000,headers:{'Content-Type':'application/json'}});export const useMenu=()=>{const[menuData,setMenuData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const fetchMenuData=async()=>{try{setLoading(true);setError(null);const url=\"\".concat(API_BASE_URL,\"/api/menu/\");console.log('ðŸŒ Conectando a:',url);const response=await api.get('/api/menu/');console.log('âœ… API respondiÃ³:',response.status);console.log('ðŸ“¦ Datos crudos:',response.data);// VERIFICAR ESTRUCTURA\nif(response.data.categories){console.log(\"\\uD83D\\uDCCA \".concat(response.data.categories.length,\" categor\\xEDas encontradas\"));response.data.categories.forEach((cat,i)=>{var _cat$items,_cat$items2;console.log(\"  Categor\\xEDa \".concat(i,\": \\\"\").concat(cat.nombre,\"\\\" con \").concat(((_cat$items=cat.items)===null||_cat$items===void 0?void 0:_cat$items.length)||0,\" \\xEDtems\"));(_cat$items2=cat.items)===null||_cat$items2===void 0?void 0:_cat$items2.forEach((item,j)=>{var _item$images;console.log(\"    \\xCDtem \".concat(j,\": \\\"\").concat(item.nombre,\"\\\" - \").concat(((_item$images=item.images)===null||_item$images===void 0?void 0:_item$images.length)||0,\" im\\xE1genes\"));});});}const transformedData=transformApiData(response.data);console.log('âœ¨ Datos transformados:',transformedData);setMenuData(transformedData);}catch(err){var _err$response;console.error('âŒ Error en fetchMenuData:',err);console.error('Detalles:',((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);setError('No se pudo cargar el menÃº. Mostrando datos de ejemplo.');const fallbackData=getFallbackData();setMenuData(fallbackData);}finally{setLoading(false);}};// Transformar datos de la API de Django al formato del frontend\nconst transformApiData=apiData=>{console.log('ðŸ“Š Transformando datos de la API:',apiData);// Si no hay categorÃ­as, devolver estructura vacÃ­a\nif(!apiData.categories||apiData.categories.length===0){return{restaurantName:apiData.restaurantName||\"Mi Restaurante\",description:\"MenÃº digital\",categories:[]};}// Transformar cada categorÃ­a\nconst transformedCategories=apiData.categories.map(category=>{var _category$items;// Transformar cada Ã­tem dentro de la categorÃ­a\nconst transformedItems=((_category$items=category.items)===null||_category$items===void 0?void 0:_category$items.map(item=>{var _item$images2;// Obtener imÃ¡genes como array de URLs\nconst itemImages=((_item$images2=item.images)===null||_item$images2===void 0?void 0:_item$images2.map(img=>img.image_url))||[];// Si no hay imÃ¡genes, usar fallback\nconst images=itemImages.length>0?itemImages:[\"https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&h=600&fit=crop&crop=center&auto=format\",\"https://images.unsplash.com/photo-1484980972926-edee96e0960d?w=800&h=600&fit=crop&crop=center&auto=format\"];return{id:item.id,name:item.nombre,// Transformar 'nombre' a 'name'\ndescription:item.descripcion||\"\",price:parseFloat(item.precio)||0,// Convertir string a nÃºmero\nimages:images,badges:item.badges?[item.badges]:[],// Convertir string a array\nrating:parseFloat(item.rating)||4.5,ingredients:item.ingredients||[],preparation_time:item.preparation_time||\"15-20 min\",portions:item.portions||\"1 persona\"};}))||[];return{id:category.id,name:category.nombre,// Transformar 'nombre' a 'name'\nitems:transformedItems};});return{restaurantName:apiData.restaurantName||\"Mi Restaurante\",description:\"MenÃº digital en tiempo real\",categories:transformedCategories};};// Datos de ejemplo mientras no hay conexiÃ³n\nconst getFallbackData=()=>{return{restaurantName:\"ðŸ½ï¸ Sabores del Mundo\",description:\"ConexiÃ³n establecida - Cargando datos...\",categories:[{id:1,name:\"Cargando...\",items:[{id:1,name:\"Conectando con la base de datos\",description:\"Los datos del menÃº se estÃ¡n cargando\",price:0,images:[\"https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&h=600&fit=crop&crop=center&auto=format\"],badges:[\"recomendado\"],rating:4.5,ingredients:[\"Actualizando en tiempo real...\"]}]}]};};useEffect(()=>{fetchMenuData();},[]);return{menuData,loading,error,refetch:fetchMenuData};};","map":{"version":3,"names":["useState","useEffect","axios","API_BASE_URL","api","create","baseURL","timeout","headers","useMenu","menuData","setMenuData","loading","setLoading","error","setError","fetchMenuData","url","concat","console","log","response","get","status","data","categories","length","forEach","cat","i","_cat$items","_cat$items2","nombre","items","item","j","_item$images","images","transformedData","transformApiData","err","_err$response","message","fallbackData","getFallbackData","apiData","restaurantName","description","transformedCategories","map","category","_category$items","transformedItems","_item$images2","itemImages","img","image_url","id","name","descripcion","price","parseFloat","precio","badges","rating","ingredients","preparation_time","portions","refetch"],"sources":["C:/Users/O/Desktop/restaurante/saborFront/src/hooks/useMenu.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\n// URL DE TU BACKEND DJANGO\r\nconst API_BASE_URL = 'http://127.0.0.1:8000';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 10000,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  }\r\n});\r\n\r\nexport const useMenu = () => {\r\n  const [menuData, setMenuData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const fetchMenuData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const url = `${API_BASE_URL}/api/menu/`;\r\n      console.log('ðŸŒ Conectando a:', url);\r\n      \r\n      const response = await api.get('/api/menu/');\r\n      console.log('âœ… API respondiÃ³:', response.status);\r\n      console.log('ðŸ“¦ Datos crudos:', response.data);\r\n      \r\n      // VERIFICAR ESTRUCTURA\r\n      if (response.data.categories) {\r\n        console.log(`ðŸ“Š ${response.data.categories.length} categorÃ­as encontradas`);\r\n        response.data.categories.forEach((cat, i) => {\r\n          console.log(`  CategorÃ­a ${i}: \"${cat.nombre}\" con ${cat.items?.length || 0} Ã­tems`);\r\n          cat.items?.forEach((item, j) => {\r\n            console.log(`    Ãtem ${j}: \"${item.nombre}\" - ${item.images?.length || 0} imÃ¡genes`);\r\n          });\r\n        });\r\n      }\r\n      \r\n      const transformedData = transformApiData(response.data);\r\n      console.log('âœ¨ Datos transformados:', transformedData);\r\n      \r\n      setMenuData(transformedData);\r\n      \r\n    } catch (err) {\r\n      console.error('âŒ Error en fetchMenuData:', err);\r\n      console.error('Detalles:', err.response?.data || err.message);\r\n      \r\n      setError('No se pudo cargar el menÃº. Mostrando datos de ejemplo.');\r\n      const fallbackData = getFallbackData();\r\n      setMenuData(fallbackData);\r\n      \r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Transformar datos de la API de Django al formato del frontend\r\n  const transformApiData = (apiData) => {\r\n    console.log('ðŸ“Š Transformando datos de la API:', apiData);\r\n    \r\n    // Si no hay categorÃ­as, devolver estructura vacÃ­a\r\n    if (!apiData.categories || apiData.categories.length === 0) {\r\n      return {\r\n        restaurantName: apiData.restaurantName || \"Mi Restaurante\",\r\n        description: \"MenÃº digital\",\r\n        categories: []\r\n      };\r\n    }\r\n    \r\n    // Transformar cada categorÃ­a\r\n    const transformedCategories = apiData.categories.map(category => {\r\n      // Transformar cada Ã­tem dentro de la categorÃ­a\r\n      const transformedItems = category.items?.map(item => {\r\n        // Obtener imÃ¡genes como array de URLs\r\n        const itemImages = item.images?.map(img => img.image_url) || [];\r\n        \r\n        // Si no hay imÃ¡genes, usar fallback\r\n        const images = itemImages.length > 0 \r\n          ? itemImages \r\n          : [\r\n              `https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&h=600&fit=crop&crop=center&auto=format`,\r\n              `https://images.unsplash.com/photo-1484980972926-edee96e0960d?w=800&h=600&fit=crop&crop=center&auto=format`\r\n            ];\r\n        \r\n        return {\r\n          id: item.id,\r\n          name: item.nombre,  // Transformar 'nombre' a 'name'\r\n          description: item.descripcion || \"\",\r\n          price: parseFloat(item.precio) || 0,  // Convertir string a nÃºmero\r\n          images: images,\r\n          badges: item.badges ? [item.badges] : [],  // Convertir string a array\r\n          rating: parseFloat(item.rating) || 4.5,\r\n          ingredients: item.ingredients || [],\r\n          preparation_time: item.preparation_time || \"15-20 min\",\r\n          portions: item.portions || \"1 persona\"\r\n        };\r\n      }) || [];\r\n      \r\n      return {\r\n        id: category.id,\r\n        name: category.nombre,  // Transformar 'nombre' a 'name'\r\n        items: transformedItems\r\n      };\r\n    });\r\n    \r\n    return {\r\n      restaurantName: apiData.restaurantName || \"Mi Restaurante\",\r\n      description: \"MenÃº digital en tiempo real\",\r\n      categories: transformedCategories\r\n    };\r\n  };\r\n\r\n  // Datos de ejemplo mientras no hay conexiÃ³n\r\n  const getFallbackData = () => {\r\n    return {\r\n      restaurantName: \"ðŸ½ï¸ Sabores del Mundo\",\r\n      description: \"ConexiÃ³n establecida - Cargando datos...\",\r\n      categories: [\r\n        {\r\n          id: 1,\r\n          name: \"Cargando...\",\r\n          items: [\r\n            {\r\n              id: 1,\r\n              name: \"Conectando con la base de datos\",\r\n              description: \"Los datos del menÃº se estÃ¡n cargando\",\r\n              price: 0,\r\n              images: [\r\n                \"https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&h=600&fit=crop&crop=center&auto=format\"\r\n              ],\r\n              badges: [\"recomendado\"],\r\n              rating: 4.5,\r\n              ingredients: [\"Actualizando en tiempo real...\"]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchMenuData();\r\n  }, []);\r\n\r\n  return {\r\n    menuData,\r\n    loading,\r\n    error,\r\n    refetch: fetchMenuData\r\n  };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}